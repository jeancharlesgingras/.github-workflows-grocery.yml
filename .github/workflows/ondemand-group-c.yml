name: OnDemand-Group-C

on:
  schedule:
    - cron: '5 * * * *'   # every hour at :05
  workflow_dispatch:

jobs:
  run_cat_group_c:
    runs-on: ubuntu-latest

    steps:
      - name: Run ONE category per run (limit=650)
        run: |
          set -euo pipefail

          CATS=(
            "Beauty & Personal Care|6205124011"
            "Clothing Men|21353444011"
            "Clothing Women|21353446011"
            "Grocery|6967215011"
            "Health & Personal Care|6205177011"
          )

          IDX=$(( ( $(date +%s) / 3600 ) % ${#CATS[@]} ))
          ENTRY=${CATS[$IDX]}

          LABEL=${ENTRY%%|*}
          CATID=${ENTRY##*|}

          echo "Running $LABEL ($CATID)"

          curl -s "${{ secrets.ONDEMAND_URL }}?secret=${{ secrets.ONDEMAND_SECRET }}&task=cat:$CATID&limit=650"
